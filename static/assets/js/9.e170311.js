(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+GtC":function(t,e,a){"use strict";a("l1tO")},"1S+P":function(t,e,a){"use strict";a.r(e);var n=a("aTiZ"),r=a("PFCU");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);var o=a("KHd+"),s=Object(o.a)(r.default,n.a,n.b,!1,null,"61311e22",null);e.default=s.exports},"2M9n":function(t,e,a){"use strict";a("IgQT")},"3fIE":function(t,e,a){"use strict";a.r(e);var n=a("Yzpn"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e.default=r.a},"4cYB":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"SummaryCard",props:{title:{type:String,default:""},cardData:{type:Object,default:function(){return{}}}},computed:{ratioCls:function(){return this.cardData.week.this_week_count===this.cardData.week.last_week_count?"ratio-equal":this.cardData.week.this_week_count>this.cardData.week.last_week_count?"ratio-up":"ratio-down"}}}},"6OwM":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r=a("WDBV"),i=(n=r)&&n.__esModule?n:{default:n};e.default={name:"PieChart",props:{height:{type:Number,default:320},chartData:{type:Object,default:function(){return{labels:[],value:[]}}},loading:{type:Boolean,default:!1}},data:function(){return{chartInstance:null}},watch:{loading:function(t){t||this.updateChart()}},mounted:function(){this.init()},methods:{init:function(){var t=this.$refs.pieChartWrap.querySelector(".pie-chart").getContext("2d"),e=this.chartData,a=e.labels,n=e.value;this.chartInstance=new i.default(t,{type:"doughnut",data:{labels:a,datasets:[{borderAlign:"center",backgroundColor:["#4b78c1","#6ca0e4","#a0b7da","#6bc265","#43bdb1","#f29292","#43bdb1","#edb073","#d8a6ef","#f0a9a9"],data:n}]},options:{maintainAspectRatio:!1,plugins:{legend:{position:"right"},tooltip:{callbacks:{label:function(t){var e=t.dataset.data.reduce((function(t,e){return t+e})),a=(t.dataPoint/e*100).toFixed(2);return t.label+": "+a+"%"}}}}}})},updateChart:function(){this.chartInstance.data.datasets[0].data=this.chartData.value,this.chartInstance.data.labels=this.chartData.labels,this.chartInstance.update()}}}},"8/TH":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"TableChart",props:{title:{type:String,default:""},desc:{type:String,default:""},showSearchInput:{type:Boolean,default:!1},showPagination:{type:Boolean,default:!1},pagination:{type:Object,default:function(){return{current:1,count:0,limit:10}}},showTop3Color:{type:Boolean,default:!0},columns:{type:Array,default:function(){return[]}},chartData:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},methods:{getRowOrder:function(t){return t+(this.pagination.current-1)*this.pagination.limit+1},getOrderCls:function(t){var e="";return 1===this.pagination.current&&t<=2&&(e=0===t?"first-order":1===t?"second-order":"third-order"),e},handleSortChange:function(t){var e=t.prop,a=t.order,n=void 0;"ascending"===a?n=e:"descending"===a&&(n="-"+e),this.$emit("onOrderChange",n)},handlePageChange:function(t){this.$emit("onPageChange",t)},handlerCellClick:function(t,e){"function"==typeof t.handler&&t.handler.call(this,e)}}}},"9mql":function(t,e,a){},"B/Kc":function(t,e,a){"use strict";a.r(e);var n=a("p0IH"),r=a("klV2");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("LmS9");var o=a("KHd+"),s=Object(o.a)(r.default,n.a,n.b,!1,null,"f31848fa",null);e.default=s.exports},DrVv:function(t,e,a){"use strict";a.r(e);var n=a("NaFw"),r=a("I+Ga");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);var o=a("KHd+"),s=Object(o.a)(r.default,n.a,n.b,!1,null,"b9601d84",null);e.default=s.exports},FlZl:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(a("WDBV")),r=i(a("EstQ"));function i(t){return t&&t.__esModule?t:{default:t}}e.default={name:"LineChart",props:{title:{type:String,default:""},desc:{type:String,default:""},showTimeDimension:{type:Boolean,default:!0},timeDimensions:{type:Array,default:function(){return[{key:"days",name:r.default.t("m['天']")},{key:"weeks",name:r.default.t("m['周']")},{key:"months",name:r.default.t("m['月']")},{key:"years",name:r.default.t("m['年']")}]}},dimension:{type:String,default:""},min:{type:Number,default:0},bgColor:{type:String,default:"rgba(37,91,175,0.3)"},gradientColor:{type:Array,default:function(){return[]}},xAxisName:{type:String,default:""},yAxisName:{type:String,default:""},height:{type:Number,default:320},chartData:{type:Object,default:function(){return{x:[],y:[]}}},loading:{type:Boolean,default:!1}},data:function(){return{chartInstance:null}},watch:{loading:function(t){t||this.updateChart()}},mounted:function(){this.init()},methods:{init:function(){var t=this.$refs.lineChartWrap.querySelector(".line-chart").getContext("2d"),e=this.chartData,a=e.x,r=e.y,i=void 0;if(2===this.gradientColor.length){var o=t.createLinearGradient(0,320,0,0);o.addColorStop(0,this.gradientColor[0]),o.addColorStop(1,this.gradientColor[1]),i=o}else i=this.bgColor;this.chartInstance=new n.default(t,{type:"line",data:{labels:a,datasets:[{data:r,fill:"start",backgroundColor:i,borderWidth:0}]},options:{maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{gridLines:{display:!1}},y:{gridLines:{borderDash:[5,3]},ticks:{precision:0},min:this.min}},crosshair:{enabled:!0}}})},updateChart:function(){this.chartInstance.data.datasets[0].data=this.chartData.y,this.chartInstance.data.labels=this.chartData.x,this.chartInstance.update()},onSelectDimension:function(t){this.$emit("onDimensionChange",t)}}}},"I+Ga":function(t,e,a){"use strict";a.r(e);var n=a("6OwM"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e.default=r.a},IgQT:function(t,e,a){},KI6W:function(t,e,a){"use strict";a.r(e);var n=a("FlZl"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e.default=r.a},LmS9:function(t,e,a){"use strict";a("9mql")},M6jI:function(t,e,a){"use strict";a.r(e);var n=a("tP67"),r=a("3fIE");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("WFq+");var o=a("KHd+"),s=Object(o.a)(r.default,n.a,n.b,!1,null,"305f9d1d",null);e.default=s.exports},MZOM:function(t,e,a){"use strict";a.r(e);var n=a("4cYB"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e.default=r.a},NLhe:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"summary-card"},[e("div",{staticClass:"icon-wrap"},[t._t("icon",(function(){return[e("i",{staticClass:"bk-icon icon-order"})]}))],2),t._v(" "),e("div",{staticClass:"summary-data-wrap"},[e("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),e("div",{staticClass:"data-detail"},[e("div",{staticClass:"total-num"},[t._v(t._s(t.cardData.total))]),t._v(" "),e("div",{staticClass:"week-data"},[e("div",{staticClass:"week-data-detail"},[e("span",{staticClass:"week-item"},[t._v("\n            "+t._s(t.$t("m.operation['上周']"))+"\n            "),e("span",{staticClass:"week-num"},[t._v(t._s(t.cardData.week.last_week_count))])]),t._v(" "),e("span",{staticClass:"week-item"},[t._v("\n            "+t._s(t.$t("m.operation['本周']"))+"\n            "),e("span",{staticClass:"week-num"},[t._v(t._s(t.cardData.week.this_week_count))])])]),t._v(" "),e("div",{staticClass:"week-detail-ratio",class:t.ratioCls},[t._m(0),t._v(" "),e("span",{staticClass:"ratio-value"},[t._v(t._s(t.cardData.week.ratio))])])])])])])},r=[function(){var t=this._self._c;return t("span",{staticClass:"ratio-icon"},[t("i",{staticClass:"bk-icon icon-arrows-right"})])}];n._withStripped=!0},NaFw:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this._self._c;return t("div",{ref:"pieChartWrap",staticClass:"pie-chart-wrap"},[t("canvas",{staticClass:"pie-chart",staticStyle:{width:"100%"},attrs:{height:this.height}})])},r=[];n._withStripped=!0},PFCU:function(t,e,a){"use strict";a.r(e);var n=a("UoRd"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e.default=r.a},UoRd:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r=a("WDBV"),i=(n=r)&&n.__esModule?n:{default:n};e.default={name:"BarChart",props:{title:{type:String,default:""},desc:{type:String,default:""},xAxisName:{type:String,default:""},yAxisName:{type:String,default:""},height:{type:Number,default:320},chartData:{type:Object,default:function(){return{x:[],y:[]}}},loading:{type:Boolean,default:!1}},data:function(){return{chartInstance:null}},watch:{loading:function(t){t||this.updateChart()}},mounted:function(){this.init()},methods:{init:function(){var t=this.$refs.barChartWrap.querySelector(".bar-chart").getContext("2d"),e=this.chartData,a=e.x,n=e.y;this.chartInstance=new i.default(t,{type:"bar",data:{labels:a,datasets:[{data:n,backgroundColor:"#4b78c1",maxBarThickness:24}]},options:{maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{gridLines:{display:!1}},y:{gridLines:{borderDash:[5,3]}}},interaction:{mode:"nearest"}}})},updateChart:function(){this.chartInstance.data.datasets[0].data=this.chartData.y,this.chartInstance.data.labels=this.chartData.x,this.chartInstance.update()}}}},VnjG:function(t,e,a){"use strict";a.r(e);var n=a("v7Pe"),r=a("KI6W");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("2M9n");var o=a("KHd+"),s=Object(o.a)(r.default,n.a,n.b,!1,null,"72181fb1",null);e.default=s.exports},"WFq+":function(t,e,a){"use strict";a("btut")},Wj9j:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-chart"},[e("bk-table",{attrs:{data:t.chartData,pagination:t.pagination,"outer-border":!1},on:{"sort-change":t.handleSortChange,"page-change":t.handlePageChange}},t._l(t.columns,(function(a){return e("bk-table-column",{key:a.key,attrs:{label:a.name,"show-overflow-tooltip":"organization"!==a.key,sortable:!!a.sort&&"custom",align:a.align||"left",prop:a.key,width:"width"in a?a.width:"auto"},scopedSlots:t._u([{key:"default",fn:function(n){return e("div",{class:{"padding-right-adjust":"right"===a.align&&a.sort}},["order"===a.key?e("div",{staticClass:"order",class:t.getOrderCls(n.$index)},[e("span",{staticClass:"order-num"},[t._v(t._s(t.getRowOrder(n.$index)))])]):"function"==typeof a.format?[e("span",{staticStyle:{"font-weigth":"700"}},[t._v(t._s(a.format.call(this,n.row)))])]:"organization"===a.key&&n.row.organization_full?[e("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:n.row.organization_full,position:"top",theme:"light"},expression:"{\n              content: props.row.organization_full,\n              position: 'top',\n              theme: 'light'\n            }"}]},[t._v("\n            "+t._s(n.row.organization)+"\n          ")])]:[a.link?e("span",{staticClass:"link",on:{click:function(e){return t.handlerCellClick(a,n.row)}}},[t._v(t._s(n.row[a.key]))]):e("span",[t._v(t._s(n.row[a.key]))])]],2)}}],null,!0)})})),1)],1)},r=[];n._withStripped=!0},Yzpn:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r=a("sEfC"),i=(n=r)&&n.__esModule?n:{default:n};e.default={name:"ChartCard",props:{title:{type:String,default:""},desc:{type:String,default:""},showSearch:{type:Boolean,default:!1},placeholder:{type:String,default:""},loading:{type:Boolean,default:!1}},data:function(){return{searchStr:""}},created:function(){this.onSearch=(0,i.default)(this.searchHandler,500)},methods:{searchHandler:function(t){this.$emit("search",t)}}}},aTiZ:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this._self._c;return t("div",{ref:"barChartWrap",staticClass:"bar-chart-wrap"},[t("canvas",{staticClass:"bar-chart",attrs:{height:this.height}})])},r=[];n._withStripped=!0},btut:function(t,e,a){},cVji:function(t,e,a){"use strict";a.r(e);var n=a("NLhe"),r=a("MZOM");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("f0iZ");var o=a("KHd+"),s=Object(o.a)(r.default,n.a,n.b,!1,null,"50614d72",null);e.default=s.exports},f0iZ:function(t,e,a){"use strict";a("iUZP")},iUZP:function(t,e,a){},klV2:function(t,e,a){"use strict";a.r(e);var n=a("t8Ze"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e.default=r.a},l1tO:function(t,e,a){},lcZY:function(t,e,a){"use strict";a.r(e);var n=a("Wj9j"),r=a("xe9B");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("+GtC");var o=a("KHd+"),s=Object(o.a)(r.default,n.a,n.b,!1,null,"2f5e1326",null);e.default=s.exports},p0IH:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this,e=t._self._c;return e("div",{ref:"operationHome",staticClass:"operation-home"},[e("div",{staticClass:"date-selector",class:{"selector-fixed":t.isDateSelectorFixed}},[e("bk-date-picker",{attrs:{type:"daterange",clearable:!1,shortcuts:t.shortcuts,value:t.dateRange},on:{change:t.onSelectDate}})],1),t._v(" "),e("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.loading.summary,opacity:1},expression:"{ isLoading: loading.summary, opacity: 1 }"}],staticClass:"summary-data statistics-section"},[e("summary-card",{attrs:{title:t.$t("m.operation['单据总数']"),"card-data":{total:t.summaryData.total.count,week:t.summaryData.week.ticket}}},[e("i",{staticClass:"bk-icon icon-order-shape",attrs:{slot:"icon"},slot:"icon"})]),t._v(" "),e("summary-card",{attrs:{title:t.$t("m.operation['服务总数']"),"card-data":{total:t.summaryData.total.service_count,week:t.summaryData.week.service}}},[e("i",{staticClass:"bk-icon icon-heart-shape",attrs:{slot:"icon"},slot:"icon"})]),t._v(" "),e("summary-card",{attrs:{title:t.$t("m.operation['业务总数']"),"card-data":{total:t.summaryData.total.biz_count,week:t.summaryData.week.biz}}},[e("i",{staticClass:"bk-icon icon-folder-open-shape",attrs:{slot:"icon"},slot:"icon"})]),t._v(" "),e("summary-card",{attrs:{title:t.$t("m.operation['用户总数']"),"card-data":{total:t.summaryData.total.user_count,week:t.summaryData.week.user}}},[e("i",{staticClass:"bk-icon icon-user-shape",attrs:{slot:"icon"},slot:"icon"})])],1),t._v(" "),e("div",{staticClass:"global-statistics statistics-section"},[e("h4",[t._v(t._s(t.$t("m.operation['全局统计']")))]),t._v(" "),e("div",{staticClass:"charts-wrap"},[e("chart-card",{staticStyle:{height:"568px"},attrs:{title:t.$t("m.operation['服务使用统计']"),"show-search":!t.loading.bizList,placeholder:t.$t("m.operation['请输入服务名称']"),loading:t.loading.serviceUse},on:{search:t.handleServiceSearch}},[e("table-chart",{attrs:{"show-pagination":!0,pagination:t.serviceTablePagination,columns:t.serviceTableColumns,"chart-data":t.serviceUseData},on:{onPageChange:t.onServiceTablePageChange,onOrderChange:t.onServiceTableOrderChange}})],1),t._v(" "),e("chart-card",{staticStyle:{height:"568px"},attrs:{title:t.$t("m.operation['业务使用统计']"),desc:t.$t("m.operation['按照业务维度，统计业务的单量以及服务使用量。']"),placeholder:t.$t("m.operation['请输入业务名称']"),"show-search":!0,loading:t.loading.bizUse},on:{search:t.handleBizSearch}},[e("table-chart",{attrs:{"show-pagination":!0,pagination:t.bizTablePagination,columns:t.bizTableColumns,"chart-data":t.bizUseData},on:{onPageChange:t.onBizTablePageChange,onOrderChange:t.onBizTableOrderChange}})],1),t._v(" "),e("chart-card",{attrs:{title:t.$t("m.operation['单据数量-按类型统计']"),loading:t.loading.ticketClassify}},[e("bar-chart",{attrs:{loading:t.loading.ticketClassify,"y-axis-name":t.$t("m.operation['单量（条）']"),"chart-data":t.ticketClassifyData}})],1),t._v(" "),e("chart-card",{attrs:{title:t.$t("m.operation['单据状态占比']"),loading:t.loading.ticketStatus}},[e("pie-chart",{attrs:{loading:t.loading.ticketStatus,"chart-data":t.ticketStatusData}})],1)],1)]),t._v(" "),e("div",{staticClass:"ticket-statistics statistics-section"},[e("h4",[t._v(t._s(t.$t("m.operation['提单统计']")))]),t._v(" "),e("div",{staticClass:"charts-wrap"},[e("chart-card",{staticStyle:{height:"410px"},attrs:{title:t.$t("m.operation['提单人数']"),loading:t.loading.creator}},[e("line-chart",{attrs:{loading:t.loading.creator,min:0,"gradient-color":["rgba(58, 132, 255, 0)","rgba(58, 132, 255, 0.3)"],"y-axis-name":t.$t("m.operation['人数（人）']"),"chart-data":t.creatorData,dimension:t.creatorChartDismension},on:{onDimensionChange:t.onCreatorDimensionChange}})],1),t._v(" "),e("chart-card",{staticStyle:{height:"410px"},attrs:{title:t.$t("m.operation['Top 10 提单用户']"),loading:t.loading.top10CreateTicketUser}},[e("table-chart",{attrs:{loading:t.loading.top10CreateTicketUser,columns:t.creatorTableColumns,"chart-data":t.top10CreateTicketUserData}})],1),t._v(" "),e("chart-card",{staticStyle:{height:"410px"},attrs:{title:t.$t("m.operation['Top 10 单据分布占比']"),desc:t.$t("m.operation['按组织架构统计']"),loading:t.loading.top10TicketOrganization}},[e("pie-chart",{attrs:{loading:t.loading.top10TicketOrganization,"chart-data":t.top10TicketOrganizationData}})],1)],1)]),t._v(" "),e("div",{staticClass:"added-statistics statistics-section"},[e("h4",[t._v(t._s(t.$t("m.operation['新增统计']")))]),t._v(" "),e("div",{staticClass:"charts-wrap"},[e("chart-card",{attrs:{title:t.$t("m.operation['新增单量']"),desc:t.$t("m.operation['选定周期内，新增的单量']"),loading:t.loading.addedTicket}},[e("line-chart",{attrs:{loading:t.loading.addedTicket,"gradient-color":["rgba(37, 91, 175, 0)","rgba(37, 91, 175, 0.3)"],"y-axis-name":t.$t("m.operation['单量（条）']"),"chart-data":t.addedTicketData,dimension:t.addedTicketChartDismension},on:{onDimensionChange:t.onAddedTicketDimensionChange}})],1),t._v(" "),e("chart-card",{attrs:{title:t.$t("m.operation['新增用户数']"),desc:t.$t("m.operation['选定周期内，新增的用户']"),loading:t.loading.addedUser}},[e("line-chart",{attrs:{loading:t.loading.addedUser,min:0,"gradient-color":["rgba(19, 143, 203, 0)","rgba(23, 142, 207, 0.3)"],"y-axis-name":t.$t("m.operation['人数（人）']"),"chart-data":t.addedUserData,dimension:t.addedUserChartDismension},on:{onDimensionChange:t.onAddedUserDimensionChange}})],1),t._v(" "),e("chart-card",{attrs:{title:t.$t("m.operation['新增服务']"),desc:t.$t("m.operation['选定周期内，新增的服务']"),loading:t.loading.addedService}},[e("line-chart",{attrs:{loading:t.loading.addedService,min:0,"gradient-color":["rgba(123, 227, 221, 0)","rgba(69, 195, 184, 0.3)"],"y-axis-name":t.$t("m.operation['服务（个）']"),"chart-data":t.addedServiceData,dimension:t.addedServiceChartDismension},on:{onDimensionChange:t.onAddedServiceDimensionChange}})],1)],1)])])},r=[];n._withStripped=!0},t8Ze:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=g(a("14Xm")),r=g(a("4d7F")),i=g(a("D3Ub")),o=g(a("Wgwc")),s=g(a("DzJC")),c=g(a("cVji")),d=g(a("M6jI")),u=g(a("lcZY")),l=g(a("VnjG")),h=g(a("1S+P")),f=g(a("DrVv")),p=g(a("EstQ"));function g(t){return t&&t.__esModule?t:{default:t}}var v="YYYY-MM-DD",m=[{key:"order",name:"No",colorMark:!0,width:80},{key:"service_name",name:p.default.t("m['服务名称']"),link:!0,handler:function(t){this.$router.push({name:this.$route.query.project_id?"projectOperationService":"OperationService",params:{id:t.service_id},query:{project_id:this.$route.query.project_id}})}},{key:"category",name:p.default.t("m['服务类型']")},{key:"count",name:p.default.t("m['单量（占比）']"),sort:!0,align:"right",format:function(t){return t.count+"("+t.ratio+")"}},{key:"creator_count",name:p.default.t("m['用户数']"),sort:!0,align:"right",width:100},{key:"biz_count",name:p.default.t("m['业务使用数']"),sort:!0,align:"right",width:110}],_=[{key:"order",name:"No",colorMark:!0,width:80},{key:"bk_biz_name",name:p.default.t("m['业务名']")},{key:"service_count",name:p.default.t("m['使用服务数量']"),sort:!0,align:"right"},{key:"count",name:p.default.t("m['单量']"),sort:!0,align:"right",width:120}],k=[{key:"order",name:"No",colorMark:!0,width:60},{key:"creator",name:p.default.t("m['用户ID']"),width:120},{key:"organization",name:p.default.t("m['所在组织']")},{key:"count",name:p.default.t("m['提单量']"),colorMark:!0,align:"right",width:120}],b={RUNNING:p.default.t("m['进行中']"),FINISHED:p.default.t("m['已完成']"),REVOKED:p.default.t("m['已撤销']"),TERMINATED:p.default.t("m['已终止']")};e.default={name:"OperationHome",components:{SummaryCard:c.default,ChartCard:d.default,TableChart:u.default,LineChart:l.default,BarChart:h.default,PieChart:f.default},data:function(){var t=(0,o.default)().format(v);return{dateRange:[(0,o.default)().subtract(1,"month").format(v),t],isDateSelectorFixed:!1,summaryData:{total:{count:0,service_count:0,biz_count:0,user_count:0},week:{ticket:{this_week_count:0,last_week_count:0,ratio:"--"},service:{this_week_count:0,last_week_count:0,ratio:"--"},biz:{this_week_count:0,last_week_count:0,ratio:"--"},user:{this_week_count:0,last_week_count:0,ratio:"--"}}},bizList:[],bizSearchIds:void 0,serviceUseData:[],serviceSearchStr:void 0,bizUseData:[],ticketClassifyData:{},ticketStatusData:{},creatorData:{},top10CreateTicketUserData:[],top10TicketOrganizationData:{},addedTicketData:{},addedUserData:{},addedServiceData:{},serviceTableColumns:m,bizTableColumns:_,creatorTableColumns:k,creatorChartDismension:"days",addedTicketChartDismension:"days",addedUserChartDismension:"days",addedServiceChartDismension:"days",serviceTablePagination:{size:"small",current:1,count:0,limit:10,"show-limit":!1},bizTablePagination:{size:"small",current:1,count:0,limit:10,"show-limit":!1},shortcuts:[{text:this.$t("m['今天']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().format(v),t]}},{text:this.$t("m['昨天']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().subtract(1,"day").format(v),t]}},{text:this.$t("m['前天']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().subtract(2,"day").format(v),t]}},{text:this.$t("m['一周前']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().subtract(1,"week").format(v),t]}},{text:this.$t("m['一个月前']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().subtract(1,"month").format(v),t]}},{text:this.$t("m['三个月前']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().subtract(3,"month").format(v),t]}},{text:this.$t("m['半年前']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().subtract(6,"month").format(v),t]}},{text:this.$t("m['一年前']"),value:function(){var t=(0,o.default)().format(v);return[(0,o.default)().subtract(1,"year").format(v),t]}}],loading:{summary:!1,bizList:!1,serviceUse:!1,bizUse:!1,ticketClassify:!1,ticketStatus:!1,creator:!1,top10CreateTicketUser:!1,top10TicketOrganization:!1,addedTicket:!1,addedUser:!1,addedService:!1},project_key:this.$route.query.project_id||void 0}},created:function(){this.getSummaryData(),this.getDetailData(),this.getBizList(),this.handleDateSelectorPosition=(0,s.default)(this.scrollHandler,300)},mounted:function(){this.$parent.$el.addEventListener("scroll",this.handleDateSelectorPosition,!1)},beforeDestroy:function(){this.$parent.$el.removeEventListener("scroll",this.handleDateSelectorPosition,!1)},methods:{getDetailData:function(){this.getServiceUseData(),this.getBizUseData(),this.getTicketClassifyData(),this.getTicketStatusData(),this.getCreatorData(),this.getTop10CreateTicketUserData(),this.getTop10TicketOrganizationData(),this.getAddedTicketData(),this.getAddedUserData(),this.getAddedServiceData()},getSummaryData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.summary=!0,e.prev=1,a={project_key:t.project_key},e.next=5,r.default.all([t.$store.dispatch("operation/getSummaryTotalData",a),t.$store.dispatch("operation/getSummaryWeekData",a)]);case 5:i=e.sent,t.summaryData={total:i[0].data,week:i[1].data},e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:return e.prev=12,t.loading.summary=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,t,[[1,9,12,15]])})))()},getBizList:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.bizList=!0,e.prev=1,a={project_key:t.project_key},e.next=5,t.$store.dispatch("eventType/getAppList",a);case 5:r=e.sent,t.bizList=r.data,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:return e.prev=12,t.loading.bizList=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,t,[[1,9,12,15]])})))()},getServiceUseData:function(t){var e=this;return(0,i.default)(n.default.mark((function a(){var r,i;return n.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.loading.serviceUse=!0,a.prev=1,r={project_key:e.project_key,create_at__gte:e.dateRange[0],create_at__lte:e.dateRange[1],page:e.serviceTablePagination.current,service_name:e.serviceSearchStr,order_by:t},a.next=5,e.$store.dispatch("operation/getServiceUseData",r);case 5:i=a.sent,e.serviceTablePagination.count=i.data.count,e.serviceUseData=i.data.items,a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),console.error(a.t0);case 13:return a.prev=13,e.loading.serviceUse=!1,a.finish(13);case 16:case"end":return a.stop()}}),a,e,[[1,10,13,16]])})))()},getBizUseData:function(t){var e=this;return(0,i.default)(n.default.mark((function a(){var r,i;return n.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.loading.bizUse=!0,a.prev=1,r={project_key:e.project_key,create_at__gte:e.dateRange[0],create_at__lte:e.dateRange[1],page:e.bizTablePagination.current,biz_id:e.bizSearchIds,order_by:t},a.next=5,e.$store.dispatch("operation/getBizUseData",r);case 5:i=a.sent,e.bizTablePagination.count=i.data.count,e.bizUseData=i.data.items,a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),console.error(a.t0);case 13:return a.prev=13,e.loading.bizUse=!1,a.finish(13);case 16:case"end":return a.stop()}}),a,e,[[1,10,13,16]])})))()},getTicketClassifyData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.ticketClassify=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1]},e.next=5,t.$store.dispatch("operation/getTicketClassifyData",a);case 5:r=e.sent,i={x:[],y:[]},r.data.forEach((function(t){var e=t.count,a=t.service_type;i.x.push(a),i.y.push(e)})),t.ticketClassifyData=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:return e.prev=14,t.loading.ticketClassify=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,t,[[1,11,14,17]])})))()},getTicketStatusData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.ticketStatus=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1]},e.next=5,t.$store.dispatch("operation/getTicketStatusData",a);case 5:r=e.sent,i={labels:[],value:[]},r.data.forEach((function(t){var e=t.status,a=t.count;i.labels.push(b[e]),i.value.push(a)})),t.ticketStatusData=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:return e.prev=14,t.loading.ticketStatus=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,t,[[1,11,14,17]])})))()},getCreatorData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.creator=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1],timedelta:t.creatorChartDismension,resource_type:"creator"},e.next=5,t.$store.dispatch("operation/getResourceCountData",a);case 5:r=e.sent,i={x:[],y:[]},r.data.forEach((function(t){var e=t.count,a=t.date;i.x.push(a),i.y.push(e)})),t.creatorData=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:return e.prev=14,t.loading.creator=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,t,[[1,11,14,17]])})))()},getTop10CreateTicketUserData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.top10CreateTicketUser=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1]},e.next=5,t.$store.dispatch("operation/getTop10CreateTicketUserData",a);case 5:r=e.sent,i=r.data.map((function(e){if(e.organization.length>0){var a=t.getFullOrganization(e.organization);e.organization_full=a.reverse().join("/"),e.organization=e.organization[0].name}else e.organization="--";return e})),t.top10CreateTicketUserData=i,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:return e.prev=13,t.loading.top10CreateTicketUser=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,t,[[1,10,13,16]])})))()},getTop10TicketOrganizationData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.top10TicketOrganization=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1]},e.next=5,t.$store.dispatch("operation/getTop10TicketOrganizationData",a);case 5:r=e.sent,i={labels:[],value:[]},r.data.forEach((function(t){var e=t.organization,a=t.count;i.labels.push(e),i.value.push(a)})),t.top10TicketOrganizationData=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:return e.prev=14,t.loading.top10TicketOrganization=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,t,[[1,11,14,17]])})))()},getAddedTicketData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.addedTicket=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1],timedelta:t.addedTicketChartDismension,resource_type:"ticket"},e.next=5,t.$store.dispatch("operation/getResourceCountData",a);case 5:r=e.sent,i={x:[],y:[]},r.data.forEach((function(t){var e=t.count,a=t.date;i.x.push(a),i.y.push(e)})),t.addedTicketData=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:return e.prev=14,t.loading.addedTicket=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,t,[[1,11,14,17]])})))()},getAddedUserData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.addedUser=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1],timedelta:t.addedUserChartDismension,resource_type:"user"},e.next=5,t.$store.dispatch("operation/getResourceCountData",a);case 5:r=e.sent,i={x:[],y:[]},r.data.forEach((function(t){var e=t.count,a=t.date;i.x.push(a),i.y.push(e)})),t.addedUserData=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:return e.prev=14,t.loading.addedUser=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,t,[[1,11,14,17]])})))()},getAddedServiceData:function(){var t=this;return(0,i.default)(n.default.mark((function e(){var a,r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading.addedService=!0,e.prev=1,a={project_key:t.project_key,create_at__gte:t.dateRange[0],create_at__lte:t.dateRange[1],timedelta:t.addedServiceChartDismension,resource_type:"service"},e.next=5,t.$store.dispatch("operation/getResourceCountData",a);case 5:r=e.sent,i={x:[],y:[]},r.data.forEach((function(t){var e=t.count,a=t.date;i.x.push(a),i.y.push(e)})),t.addedServiceData=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:return e.prev=14,t.loading.addedService=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,t,[[1,11,14,17]])})))()},getFullOrganization:function(t){var e=t[0],a=[e.name];if(e.family&&e.family.length>0){var n=this.getFullOrganization(e.family);a=a.concat(n)}return a},onSelectDate:function(t){this.dateRange=t,this.serviceTablePagination.current=1,this.bizTablePagination.current=1,this.getDetailData()},scrollHandler:function(t){this.isDateSelectorFixed=t.target.scrollTop>150},handleServiceSearch:function(t){this.serviceSearchStr=t||void 0,this.serviceTablePagination.current=1,this.getServiceUseData()},handleBizSearch:function(t){if(this.bizTablePagination.current=1,""!==t){var e=this.bizList.filter((function(e){return e.name.toLowerCase().includes(t)}));e.length>0?(this.bizSearchIds=e.map((function(t){return t.key})).join(","),this.getBizUseData()):(this.bizTablePagination.count=0,this.bizUseData=[],this.bizSearchIds=void 0)}else this.bizSearchIds=void 0,this.getBizUseData()},onServiceTablePageChange:function(t){this.serviceTablePagination.current=t,this.getServiceUseData()},onServiceTableOrderChange:function(t){this.serviceTablePagination.current=1,this.getServiceUseData(t)},onBizTablePageChange:function(t){this.bizTablePagination.current=t,this.getBizUseData()},onBizTableOrderChange:function(t){this.bizTablePagination.current=1,this.getBizUseData(t)},onCreatorDimensionChange:function(t){this.creatorChartDismension=t,this.getCreatorData()},onAddedTicketDimensionChange:function(t){this.addedTicketChartDismension=t,this.getAddedTicketData()},onAddedUserDimensionChange:function(t){this.addedUserChartDismension=t,this.getAddedUserData()},onAddedServiceDimensionChange:function(t){this.addedServiceChartDismension=t,this.getAddedServiceData()}}}},tP67:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chart-card"},[e("div",{staticClass:"card-header"},[e("h4",[t._v("\n      "+t._s(t.title)+"\n      "),t.desc?e("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{content:t.desc,placement:"top",theme:"light"},expression:"{\n        content: desc,\n        placement: 'top',\n        theme: 'light'\n      }"}],staticClass:"bk-icon icon-info"}):t._e()]),t._v(" "),t.showSearch?e("div",{staticClass:"search-wrap"},[e("bk-input",{attrs:{"right-icon":"bk-icon icon-search",placeholder:t.placeholder,value:t.searchStr,clearable:!0},on:{change:t.onSearch}})],1):t._e()]),t._v(" "),e("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.loading,opacity:1},expression:"{ isLoading: loading, opacity: 1 }"}],staticClass:"card-content"},[t._t("default")],2)])},r=[];n._withStripped=!0},v7Pe:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this._self._c;return t("div",{ref:"lineChartWrap",staticClass:"line-chart"},[this.showTimeDimension?t("div",{staticClass:"time-dimension-selector"},[t("bk-select",{attrs:{clearable:!1,value:this.dimension},on:{selected:this.onSelectDimension}},this._l(this.timeDimensions,(function(e){return t("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1):this._e(),this._v(" "),t("canvas",{staticClass:"line-chart",attrs:{height:this.height}})])},r=[];n._withStripped=!0},xe9B:function(t,e,a){"use strict";a.r(e);var n=a("8/TH"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e.default=r.a}}]);